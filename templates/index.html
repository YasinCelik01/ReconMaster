<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ReconMaster</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
  <canvas id="matrix" class="matrix-bg"></canvas>
  <div class="container mt-5">
    <div class="text-center mb-4">
      <h1 class="display-4 glitch" data-text="üïµÔ∏è ReconMaster">üïµÔ∏è ReconMaster</h1>
      <p class="lead">Advanced Reconnaissance Suite for Ethical Hackers</p>
    </div>

    <div class="row justify-content-center">
      <div class="col-md-10">
        <div class="card">
          <div class="card-body">
            <form method="POST" action="/">
              <!-- URL + dropdown for past results -->
              <div class="mb-3">
                <label for="url" class="form-label">Target URL or Domain</label>
                <div class="input-group">
                  <input type="text"
                         class="form-control"
                         id="url"
                         name="url"
                         placeholder="example.com"
                         required>
                    <button class="btn btn-outline-secondary dropdown-toggle"
                            type="button"
                            data-bs-toggle="dropdown"
                            aria-expanded="false">
                    <!-- Bootstrap otomatik caret ekliyor, ekstra i√ßerik yok -->
                    </button>
                  <ul class="dropdown-menu dropdown-menu-end">
                    {% for f in files %}
                    <li>
                      <a class="dropdown-item"
                        href="{{ url_for('index', results_file=f.name) }}">
                        {{ f.display }}
                      </a>
                    </li>
                    {% endfor %}
                  </ul>
                </div>
              </div>

              <div class="row">
                <!-- Passive Recon Modules -->
                <div class="col-md-4">
                  <fieldset class="mb-3">
                    <legend>Passive Modules</legend>
                    {% set passive_mods = [
                        ('whois', 'WHOIS'),
                        ('dns', 'DNS'),
                        ('subfinder', 'Subfinder'),
                        ('shosubgo', 'ShosubGo'),
                        ('github', 'GitHub Subdomains'),
                        ('wayback', 'Wayback'),
                        ('smap', 'Shodan Port Scan'),
                        ('googledorks', 'Google Dorks')
                    ] %}
                    {% for value, label in passive_mods %}
                    <div class="form-check">
                      <input class="form-check-input"
                             type="checkbox"
                             name="modules"
                             value="{{ value }}"
                             id="mod_{{ value }}"
                             checked>
                      <label class="form-check-label" for="mod_{{ value }}">{{ label }}</label>
                    </div>
                    {% endfor %}
                  </fieldset>
                </div>

                <!-- Active Recon Modules -->
                <div class="col-md-4">
                  <fieldset class="mb-3">
                    <legend>Active Modules</legend>
                    {% set active_mods = [
                        ('katana', 'Katana'),
                        ('linkfinder', 'JS LinkFinder'),
                        ('nmap', 'Nmap'),
                        ('wappalyzer', 'Wappalyzer'),
                        ('waf', 'WAFW00f')
                    ] %}
                    {% for value, label in active_mods %}
                    <div class="form-check">
                      <input class="form-check-input"
                             type="checkbox"
                             name="modules"
                             value="{{ value }}"
                             id="mod_{{ value }}"
                             checked>
                      <label class="form-check-label" for="mod_{{ value }}">{{ label }}</label>
                    </div>
                    {% endfor %}
                  </fieldset>
                </div>

                <!-- Post-Recon Modules -->
                <div class="col-md-4">
                  <fieldset class="mb-3">
                    <legend>Post-Scan Modules</legend>
                    <div class="form-check">
                      <input class="form-check-input"
                             type="checkbox"
                             name="modules"
                             value="httpx"
                             id="mod_httpx">
                      <label class="form-check-label" for="mod_httpx">HTTPX Scan</label>
                    </div>
                    <div class="form-check mt-2">
                      <input class="form-check-input"
                             type="checkbox"
                             name="modules"
                             value="telegram"
                             id="mod_telegram">
                      <label class="form-check-label" for="mod_telegram">
                        Send Results with Telegram Bot
                      </label>
                    </div>
                  </fieldset>
                </div>
              </div>

              <div class="text-center">
                <button type="submit" class="btn btn-primary" onclick="showLoading()">
                  <i class="bi bi-search"></i> Start Reconnaissance
                </button>
              </div>
            </form>
          </div>
        </div>

        <div id="loading" class="loading">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <p class="mt-2">Running reconnaissance... This may take a few minutes.</p>
        </div>

        {% if results %}
        <div class="result-section">
          <h3>
            Results for 
            <span class="timestamp">{{ header_timestamp }}</span>
          </h3>

          <div class="row">
            <!-- Passive Results -->
            <div class="col-md-6">
              <h4>Passive Reconnaissance</h4>
              <div class="accordion" id="passiveAccordion">
                {% if results.passive.whois_result %}
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button" type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#whoisCollapse">
                      WHOIS Information
                    </button>
                  </h2>
                  <div id="whoisCollapse" class="accordion-collapse collapse show"
                       data-bs-parent="#passiveAccordion">
                    <div class="accordion-body">
                      <pre>{{ results.passive.whois_result }}</pre>
                    </div>
                  </div>
                </div>
                {% endif %}
                {% if results.passive.dns_info %}
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#dnsCollapse">
                      DNS Information
                    </button>
                  </h2>
                  <div id="dnsCollapse" class="accordion-collapse collapse"
                       data-bs-parent="#passiveAccordion">
                    <div class="accordion-body">
                      <div class="table-responsive">
                        <table class="table table-striped">
                          <thead>
                            <tr>
                              <th>#</th>
                              <th>Type</th>
                              <th>Source/Domain</th>
                              <th>Target/IP</th>
                            </tr>
                          </thead>
                          <tbody>
                            {% for record in results.passive.dns_info.records %}
                            <tr>
                              <td>{{ loop.index }}</td>
                              <td>{{ record.type }}</td>
                              <td>
                                {% if record.type == 'CNAME' %}
                                  {{ record.source }}
                                {% else %}
                                  {{ record.domain }}
                                {% endif %}
                              </td>
                              <td>
                                {% if record.type == 'CNAME' %}
                                  {{ record.target }}
                                {% else %}
                                  {{ record.ip }}
                                {% endif %}
                              </td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
                {% endif %}
                {% if results.passive.subdomains %}
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#subdomainsCollapse">
                      Subdomains ({{ results.passive.subdomains|length }} found)
                    </button>
                  </h2>
                  <div id="subdomainsCollapse" class="accordion-collapse collapse"
                       data-bs-parent="#passiveAccordion">
                    <div class="accordion-body">
                      <div class="table-responsive">
                        <table class="table table-striped">
                          <thead>
                            <tr><th>#</th><th>Subdomain</th></tr>
                          </thead>
                          <tbody>
                            {% for sub in results.passive.subdomains %}
                            <tr>
                              <td>{{ loop.index }}</td>
                              <td>{{ sub }}</td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
                {% endif %}
                {% if results.passive.endpoints %}
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#passiveEndpointsCollapse">
                      Passive Endpoints ({{ results.passive.endpoints|length }} found)
                    </button>
                  </h2>
                  <div id="passiveEndpointsCollapse" class="accordion-collapse collapse"
                       data-bs-parent="#passiveAccordion">
                    <div class="accordion-body">
                      <div class="table-responsive">
                        <table class="table table-striped">
                          <thead>
                            <tr><th>#</th><th>Endpoint</th></tr>
                          </thead>
                          <tbody>
                            {% for ep in results.passive.endpoints %}
                            <tr>
                              <td>{{ loop.index }}</td>
                              <td>{{ ep }}</td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
                {% endif %}
                {% if results.passive.open_ports %}
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#passivePortsCollapse">
                      Open Ports ({{ results.passive.open_ports|length }} found)
                    </button>
                  </h2>
                  <div id="passivePortsCollapse" class="accordion-collapse collapse"
                       data-bs-parent="#passiveAccordion">
                    <div class="accordion-body">
                      <div class="table-responsive">
                        <table class="table table-striped">
                          <thead>
                            <tr><th>#</th><th>Port Information</th></tr>
                          </thead>
                          <tbody>
                            {% for port in results.passive.open_ports %}
                            <tr>
                              <td>{{ loop.index }}</td>
                              <td>{{ port }}</td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
                {% endif %}
              </div>
            </div>

            <!-- Active Results -->
            <div class="col-md-6">
              <h4>Active Reconnaissance</h4>
              <div class="accordion" id="activeAccordion">
                {% if results.active.endpoints %}
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button" type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#endpointsCollapse">
                      Endpoints ({{ results.active.endpoints|length }} found)
                    </button>
                  </h2>
                  <div id="endpointsCollapse" class="accordion-collapse collapse show"
                       data-bs-parent="#activeAccordion">
                    <div class="accordion-body">
                      <div class="table-responsive">
                        <table class="table table-striped">
                          <thead>
                            <tr><th>#</th><th>Endpoint</th></tr>
                          </thead>
                          <tbody>
                            {% for ep in results.active.endpoints %}
                            <tr>
                              <td>{{ loop.index }}</td>
                              <td>{{ ep }}</td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
                {% endif %}
                {% if results.active.open_ports %}
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#portsCollapse">
                      Open Ports ({{ results.active.open_ports|length }} found)
                    </button>
                  </h2>
                  <div id="portsCollapse" class="accordion-collapse collapse"
                       data-bs-parent="#activeAccordion">
                    <div class="accordion-body">
                      <div class="table-responsive">
                        <table class="table table-striped">
                          <thead>
                            <tr><th>#</th><th>Port Information</th></tr>
                          </thead>
                          <tbody>
                            {% for port in results.active.open_ports %}
                            <tr>
                              <td>{{ loop.index }}</td>
                              <td>{{ port }}</td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
                {% endif %}
                {% if results.active.waf %}
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#wafCollapse">
                      WAF Information
                    </button>
                  </h2>
                  <div id="wafCollapse" class="accordion-collapse collapse"
                       data-bs-parent="#activeAccordion">
                    <div class="accordion-body">
                      <pre>{{ results.active.waf }}</pre>
                    </div>
                  </div>
                </div>
                {% endif %}
                {% if results.active.wappalyzer %}
                <div class="accordion-item">
                  <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#techCollapse">
                      Technologies (Wappalyzer)
                    </button>
                  </h2>
                  <div id="techCollapse" class="accordion-collapse collapse"
                       data-bs-parent="#activeAccordion">
                    <div class="accordion-body">
                      <pre>{{ results.active.wappalyzer|tojson(indent=2) }}</pre>
                    </div>
                  </div>
                </div>
                {% endif %}
              </div>
            </div>

          </div>
        </div>
        {% endif %}
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
